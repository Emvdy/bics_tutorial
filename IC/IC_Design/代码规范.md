| 文档名称 Document name    | 文档密级confidentiality level |
|---------------------------|-------------------------------|
| 编码规范                  |                               |
| 文档版本 document version | 共 xx 页 total xx page        |
| v1.0                      |                               |

**Verilog编码规范**

作者： 余洋

日期： 2021.07.18

修订记录

| 日期      | 修订版本 | 描述 | 作者 |
|-----------|----------|------|------|
| 2021-7-18 | V1.0     | 初稿 | 余洋 |
|           |          |      |      |
|           |          |      |      |
|           |          |      |      |

# 

## 信号命名

命名字符集为：字母A\~Z和a\~z，数字0\~9以及下划线

名称不能以数字开头

名称中两个词之间用下划线“_”连接，但不能连续使用下划线

名称不能包含非字母的符号

信号名称在不区分大小写的情况下必须保持唯一

顶层端口的信号名使用大写

内部模块的信号名使用小写

信号名长度最好不要超过20个字符

避免使用verilog保留字命令进行命名

## 信号定义

Parameter使用大写，通常用来定义有实际意义的常数，每行定义一个，放在代码的最前端

Local parameter定义紧跟module的输入输出定义之后

信号命名时应有意义，添加的前缀后缀应有意义，且应符合常用命名规范

信号缩写的含义应该在各模块中保持一致，同一信号在代码的不同层次中也应尽量保持一致

原则上一行只定义一个信号

信号的位宽使用降序描述“[m:0]”

定义信号类型左端对齐，定义位宽左括号对齐，定义信号名左端对齐

建议将端口信号的输入输出方向，信号类型，位宽都写在端口列表中，比如：

module FF

(

input clk , // clock

input rst_n , // reset

input [m:0] dat_in , // data input

output reg [n:0] dat_out // data output

);

建议将具有相同功能的信号或同一功能点的信号集中放在一起

模块所有需要定义的内部信号都放在端口信号定义之后，如果有localparam，则放在localparam之后

module

(

);

localparam PARAM1;

localparam PARAM2;

reg [m1:0] signal1;

reg [m2:0] signal2;

## 信号缩写

低电平有效信号用“_n”作为后缀，比如rst_n

纯延迟信号打拍用“_dly”或者“_d”作为后缀

时钟信号命名以“_clk”结尾

复位信号命名以“_rst_n”结尾

根据信号类型、信号功能定义信号的后缀

模块间互联信号以“模块A缩写_模块B缩写_信号缩写”的方式命名，比如“dec_enc_req、enc_dec_vld”，方便顶层连线

如果信号有多个后缀，建议最后一个后缀的优先级最高

模块内部信号的缩写要求能基本表面此信号的意义，如常用缩写“wr、rd”，或者使用单词的前几个字母

可访问寄存器在尾部添加寄存器类型的后缀，如“_r”“_wr”

## 宏定义

宏定义用大写

所有宏定义用文件统一管理

代码中有多种工作模式尽量通过宏定义进行管理，比如正常模式/测试模式/FPGA模式

# 

## 文件头

每一个文件都需要添加文件头，格式如下，说明本文件的基本信息，包括公司信息、文件信息、创建信息

//======================================================

// Copyright © 2018 Deepcreatic Technologies Co.Ltd

// All rights reserved

//--------------------------------------------------------------------------------------------

// File Name ：xxx.v

// Author ：yuyang

// Creat Date ：09/29/2018 03:35:03 AM

// Version ：1.0

// Function Description ：

//

//======================================================

如使用vim编辑器，则可以在.vimrc中设置新建文件自动生成文件头

## 修改注释

代码修改新版本时，添加修改信息

//--------------------------------------------------------------------------------------------

// Modified By ：

// Modified Date ：

// Version ：

// Description ：

//

//--------------------------------------------------------------------------------------------

## 模块名

模块名小写

模块英文名为多个单词时，建议将各单词的首字母组合起来，形成模块名

如果模块的英文名只有一个单词，建议取单词的前几个字母作为模块名

模块间的信号命名分为两部分，第一部分为数据方向，第二部分为数据名称

模块例化时采用u_xxx进行标示，比如例化一个FIFO u_INPUT_FIFO（）；

模块例化时采用端口名字关联方式，而非绝对位置关系

FIFO U_OUTPUT_FIFO

(

.port1 (connect signal1),

.port2 (connect signal2),

.port3 (connect signal3),

.port3 (connect signal3)

);

模块名与文件名应该保持一致

## 代码注释

信号定义注释，在信号后面用“// xxx”格式表示

模块注释可以通过下面的方式在模块前进行说明，可以分割功能模块，也能提高程序的可读性

//\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

// module A function

//\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

模块内进程的注释可以通过下面的方式注释

//--------------------------------

// step A

//--------------------------------

使用英文进行注释

关键语句、不易理解的语句建议都添加注释，提高代码的可读性

屏蔽代码使用单行注释//，不使用多行注释/\*......\*/，//后空一格再进行注释

# 

## 描述规则

每一行尽量只有一条语句，而且每行代码不宜过长，尽量限制在80个字符以内

不同变量、符合间保留一个空格，关键字与字符串间保留一个空格，比如

always @ (posedge clk or negedge rst_n)

逻辑运算符、算术运算符、比较运算符两侧保留一个空格，比如

sig_c = sig_a + sig_b;

单操作数运算符位于操作数前

sig_d = \~sig_e;

begin/end使用时，建议begin与always同行，放在行末尾，end与语句块首对齐，减少行数。比如：

always @ (posedge clk or negedge rst_n) begin

if (rst_n == 1’b0) beign

end

else begin

end

end

一个always块只包含一个时钟一个复位

条件判断语句用显式的表达进行描述，比如（rst_n == 1’b0），而不是（\~rst_n）

条件判断语句要定义位宽，比如（cnt == 10’d100）

信号的位宽需要保持一致，比如

if (rst_n == 1’b0)

clk_cnt \<= 10’d0;

else

clk_cnt \<= clk_cnt + 10’d1;

每一小节代码之间加一行或多行空行用于分隔

使用4个空格和换行来进行缩进对齐，不要直接使用tab键

在代码中不能含有不可综合语句，比如不能利用initial结构进行初始化赋值，应采用复位的方式对信号进行初始化赋值

Always块的敏感事件列表中应该是沿触发事件，不要出现电平触发事件

避免使用锁存器

模块输入输出信号尽量用寄存器进行寄存

三态逻辑在顶层使用，避免在子模块中使用三态逻辑

每个文件只有一个模块，不要在一个文件中放入多个模块

信号逻辑处理的位宽需要一致，加1时也需要定义位宽x’b1

组合逻辑不能太复杂

代码尽量简单，避免使用少见的语法，综合时优化粒度低

If嵌套语句不能太多，不推荐使用5级以上的if…else

建议每个模块都添加timescale

尽量避免将时钟信号当作数据输入

Always块中，只用阻塞赋值描述组合逻辑，非阻塞赋值描述时序逻辑，不要在同一个always块中同时使用阻塞和非阻塞方式，不要在不同的always块中对同一变量赋值

逻辑内部不对input进行驱动，即在module内不存在没有驱动源的信号

不能在模块端口存在没有驱动的输出信号

顶层模块中，除了内部信号的互联和module的例化外，避免出现其它逻辑

内部模块端口避免inout，尽量在顶层模块处理双向信号

三态逻辑可以在顶层使用，避免在子模块中使用三态

保留端口及信号要进行注释，通常用作逻辑升级

不允许代码中出现定义的parameter/wire/reg没有使用

除了移位寄存器之外，每个always语句只对一个变量赋值，尽量避免在一个always语句中出现多个变量进行运算或赋值

在表达式内用括号表示运算的优先级

不要使用综合工具不支持的电路

接口信号尽量少，时序尽量简单

为了便于综合和后端约束，尽量将状态机与其它电路分开，将异步电路与同步电路分开

合理划分设计的功能模块，相关逻辑放在同一个模块中，保证模块功能的独立性

合理划分模块的大小，避免模块过大

顶层模块中，时钟信号必须可见，不要在模块内部生成时钟信号

信号不能一会使用上沿一会使用下沿
